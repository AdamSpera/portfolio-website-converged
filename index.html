<!DOCTYPE html>
<html>

<head>
  <title>Adam Spera's Website</title>
  <meta name="viewport"
    content="width=device-width, initial-scale=1.0, maximum-scale=12.0, minimum-scale=1.0, user-scalable=yes">
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/showdown/1.9.1/showdown.min.js"></script>
  <link rel="stylesheet" href="styles.css">
</head>

<body>
  <br>

  <div id="header-section"></div>

  <div id="docs" style="display: none;"></div>

  <!-- START HOME -->
  <div id="home">

    <!-- WELCOME -->
    <div class="heading">Welcome to my site!</div>
    <hr>
    <p>
      This is my personal website where you can find info about myself, project showcases, and documentation I have
      gathered over the years.
    </p>

    <!-- ARTICLES section -->
    <div class="heading">Articles</div>
    <hr>
    <p style="text-align: left; margin-bottom: 1ch;">
      10/16/2023: <a target="_blank"
        href="https://www.linkedin.com/pulse/idiosplash-open-source-meraki-ipsk-solution-wireless-networks-spera-tyfde/">Open-Source
        Meraki IPSK Solution for Wireless Networks</a><br>
      11/22/2024: <a target="_blank"
        href="https://www.linkedin.com/pulse/installing-cml-windows-11-using-vmware-player-adam-spera-xyzve/">Installing
        CML on Windows 11 using VMware Player</a><br>
      04/07/2024: <a target="_blank"
        href="https://www.linkedin.com/posts/adamtspera_dpanel-presentation-activity-7183113085233049600-9Dcy?utm_source=share&utm_medium=member_desktop">Multiplatform
        Lightweight Docker Management System</a><br>
    </p>

    <!-- DOCUMENTATION section -->
    <div class="heading">Documentation</div>
    <hr>
    <div class="button-container">
      <button class="toggle-button" onclick="filterByTopic('Networking')">Networking</button>
      <button class="toggle-button" onclick="filterByTopic('Programming')">Programming</button>
      <button class="toggle-button" onclick="filterByTopic('Automation')">Automation</button>
      <button class="toggle-button" onclick="filterByTopic('Enterprise')">Enterprise</button>
      <button class="toggle-button" onclick="filterByTopic('Data Center')">Data Center</button>
      <button class="toggle-button" onclick="filterByTopic('Service Provider')">Service Provider</button>
    </div>
    <p class="docs" style="text-align: left; margin-bottom: 1ch; margin-top: 1ch;">
      - <a data-topic="ND">Virtual Extensible LAN (VXLAN)</a><br>
      - <a data-topic="ND">Application Centric Infrastructure (ACI)</a><br>
      - <a data-topic="NE">Link Aggregation Control Protocol (LACP)</a><br>
      - <a data-topic="PA">Netmiko Python Library for SSH</a><br>
    </p>

  </div>
  <!-- END HOME -->

  <div id="footer-section"></div>

  <script>
    $(window).on('popstate', function() {
      var params = new URLSearchParams(window.location.search);
      var doc = params.get('doc');

      if (!doc) {
        $('#docs').empty().hide();
        $('#home').show();
      } else {
        loadDoc(doc);
      }
    });

    $(document).ready(function () {
      $("#header-section").load("includes/header.html");
      $("#footer-section").load("includes/footer.html");

      var lastRequestTime = localStorage.getItem('lastRequestTime');
      var currentTime = new Date().getTime();

      if(lastRequestTime && currentTime - lastRequestTime < 24 * 60 * 60 * 1000) {
        // less than a day has passed since the last request, use cached data
        var result = JSON.parse(localStorage.getItem('cachedData'));
        populateDocs(result);
      } else {
        // a day or more has passed since the last request, make a new request
        $.ajax({
          url: "/documentation",
          cache: true,
          success: function (result) {
            // store the time of the request and the data in localStorage
            localStorage.setItem('lastRequestTime', currentTime);
            localStorage.setItem('cachedData', JSON.stringify(result));
            populateDocs(result);
          }
        });
      }

      var params = new URLSearchParams(window.location.search);
      var doc = params.get('doc');

      if (doc) {
        loadDoc(doc);
      }

    });

    function loadDoc(doc) {
      $('#home').hide();
      $('#docs').show();

      $.ajax({
        url: "/documentation/" + encodeURIComponent(doc) + ".md",
        dataType: "text",
        success: function (result) {
          var converter = new showdown.Converter();
          var html = converter.makeHtml(result);
          $('#docs').append(html);
          $('#docs').find('h1, h2, h3, h4, h5, h6').addClass('heading');
          $('#docs').find('h1, h2, h3, h4, h5, h6').after('<hr>');
          // $('#docs').find('hr:first').after('<br>');
        }
      });
    }

    function populateDocs(result) {
      var fileNames = result.map(function (file) {
        return file.name;
      });

      var docsElement = $(".docs");
      docsElement.empty();

      fileNames.forEach(function (fileName) {
        var splitName = fileName.split(' ');
        var topics = splitName[0];
        var name = splitName.slice(1).join(' ').replace('.md', '');

        // Remove the tags from the name
        name = name.replace(/\[.*?\]/g, '').trim();

        var link = $("<a href='#' data-topic='" + topics + "'>" + name + "</a>");
        link.click(function (e) {
          e.preventDefault();
          window.history.pushState({}, '', '?doc=' + encodeURIComponent(topics + " " + name));
          loadDoc(topics + " " + name);
        });

        docsElement.append("- ").append(link).append("<br>");
      });
    }

    function filterByTopic(topic) {
      $(event.target).toggleClass('active');

      var activeTopics = $('.toggle-button.active').map(function () {
        return $(this).text()[0];
      }).get();

      $('.docs a').each(function () {
        var linkTopics = $(this).attr('data-topic');
        var isActive = activeTopics.some(function (activeTopic) {
          return linkTopics.includes(activeTopic);
        });

        if (activeTopics.length > 0) {
          $(this).toggleClass('grey-out', !isActive);
        } else {
          $(this).removeClass('grey-out');
        }
      });

      console.log(activeTopics);
    }
  </script>
</body>

</html>